"use strict";function mapCallback(){window.map=new google.maps.Map(document.getElementById("map"),{center:{lat:0,lng:0},zoom:2,mapTypeControl:!1});var o=document.getElementById("search"),n=new google.maps.places.SearchBox(o);window.map.controls[google.maps.ControlPosition.TOP_LEFT].push(o),window.map.addListener("bounds_changed",function(){n.setBounds(window.map.getBounds())}),n.addListener("places_changed",function(){var o=n.getPlaces();if(0!==o.length){var e=new google.maps.LatLngBounds;o.forEach(function(o){o.geometry.viewport?e.union(o.geometry.viewport):e.extend(o.geometry.location)}),window.map.fitBounds(e)}}),geoipLoadScript(),$.ajax({url:"merchants.json",success:function(o){var i=new google.maps.InfoWindow;o.filter(function(o){return o.location.hasOwnProperty("latlong")}).forEach(function(n,o){var a=new google.maps.Marker({position:n.location.latlong,map:window.map}),e='<div><a id="merchant'+o+'" href="#">'+n.name+"</a></div><div>"+n.service+"</div>",t=new google.maps.InfoWindow({content:e});a.addListener("click",function(){i.close(),(i=t).open(window.map,a),$("#merchant"+o).click(function(o){o.preventDefault(),$("#merchantModal").modal(),$("#merchantModalTitle").text(n.name);var e="<div>"+n.service+"</div>";n.location.hasOwnProperty("url")&&(e+='<div><a target="_blank" href="'+n.location.url+'">'+n.location.url+"</a></div>"),n.location.hasOwnProperty("city")&&(e+="<div>"+n.location.city+"</div>"),$("#merchantModalContent").html(e),window.map.setCenter(a.getPosition()),window.map.setZoom(15)})})})}})}function geoipLoadScript(){var o=document.createElement("script");o.src="http://api.ipapi.com/check?access_key=495896f17cbf2d91180c8b8be75ae10b&callback=geoipCallback",document.body.appendChild(o)}function geoipCallback(o){var e=new google.maps.LatLng(o.latitude,o.longitude);window.map.setCenter(e),window.map.setZoom(10)}